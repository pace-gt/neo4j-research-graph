<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Neo4j Database Creation: SlurmJob.SlurmJob Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Neo4j Database Creation<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">The goal of this project is to pull information from the OpenAlex public API and upload that information into Neo4j in order to create a database of authors, institutions, and works related to Georgia Tech.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>SlurmJob</b></li><li class="navelem"><a class="el" href="class_slurm_job_1_1_slurm_job.html">SlurmJob</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="class_slurm_job_1_1_slurm_job-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">SlurmJob.SlurmJob Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8ef5c40a61a26d191645b7cff05b85a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_slurm_job_1_1_slurm_job.html#a8ef5c40a61a26d191645b7cff05b85a8">__init__</a> (self, account, python_env_location, num_nodes=1, cores_per_node=4, mem_per_core='7G', job_duration='3:00:00')</td></tr>
<tr class="separator:a8ef5c40a61a26d191645b7cff05b85a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72c79e9e1d0012673919404156da4aae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_slurm_job_1_1_slurm_job.html#a72c79e9e1d0012673919404156da4aae">remove_duplicates</a> (self)</td></tr>
<tr class="separator:a72c79e9e1d0012673919404156da4aae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b9493100437f493880cc1bcb58ef21"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_slurm_job_1_1_slurm_job.html#a71b9493100437f493880cc1bcb58ef21">download_files</a> (self)</td></tr>
<tr class="separator:a71b9493100437f493880cc1bcb58ef21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5890dae9e209eb8029e089c16a171ab8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_slurm_job_1_1_slurm_job.html#a5890dae9e209eb8029e089c16a171ab8">upload_to_neo4j</a> (self, url, username, password, database)</td></tr>
<tr class="separator:a5890dae9e209eb8029e089c16a171ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a666c12fe8852581bd591c04338e585cb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_slurm_job_1_1_slurm_job.html#a666c12fe8852581bd591c04338e585cb">run_tests_on_cleaning</a> (self)</td></tr>
<tr class="separator:a666c12fe8852581bd591c04338e585cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa524009a04b18abab5a08ec31cfea1c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_slurm_job_1_1_slurm_job.html#aa524009a04b18abab5a08ec31cfea1c2">print_nums_in_file</a> (self)</td></tr>
<tr class="separator:aa524009a04b18abab5a08ec31cfea1c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:af4452f14eb240ed4eefe709697810c8c"><td class="memItemLeft" align="right" valign="top"><a id="af4452f14eb240ed4eefe709697810c8c" name="af4452f14eb240ed4eefe709697810c8c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>account</b></td></tr>
<tr class="separator:af4452f14eb240ed4eefe709697810c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5851903262284e29b0512ddc13d7b991"><td class="memItemLeft" align="right" valign="top"><a id="a5851903262284e29b0512ddc13d7b991" name="a5851903262284e29b0512ddc13d7b991"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>num_nodes</b></td></tr>
<tr class="separator:a5851903262284e29b0512ddc13d7b991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000368e76f9d36c9f3bb3fabdeae335b"><td class="memItemLeft" align="right" valign="top"><a id="a000368e76f9d36c9f3bb3fabdeae335b" name="a000368e76f9d36c9f3bb3fabdeae335b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>cores_per_node</b></td></tr>
<tr class="separator:a000368e76f9d36c9f3bb3fabdeae335b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e65aa3f793d0ad984bb34106feac813"><td class="memItemLeft" align="right" valign="top"><a id="a0e65aa3f793d0ad984bb34106feac813" name="a0e65aa3f793d0ad984bb34106feac813"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>mem_per_core</b></td></tr>
<tr class="separator:a0e65aa3f793d0ad984bb34106feac813"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef20e23cb56796b7c966f4353400668"><td class="memItemLeft" align="right" valign="top"><a id="a7ef20e23cb56796b7c966f4353400668" name="a7ef20e23cb56796b7c966f4353400668"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>job_duration</b></td></tr>
<tr class="separator:a7ef20e23cb56796b7c966f4353400668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2687f790912f3e3c1cee3abb363a03b9"><td class="memItemLeft" align="right" valign="top"><a id="a2687f790912f3e3c1cee3abb363a03b9" name="a2687f790912f3e3c1cee3abb363a03b9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>python_env_location</b></td></tr>
<tr class="separator:a2687f790912f3e3c1cee3abb363a03b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">A class representing a slurm job

Imports
-------
Uses the File class from this project
os
Popen, PIPE from subprocess

Methods
-------
remove_duplicates():
    Create and submit a job to remove all duplicates from the downloaded files
download_files():
    Create and submit a job to download all files
upload_to_neo4j():
    Create and submit a job to upload all nodes to Neo4j
run_tests_on_cleaning():
    Create and submit a job to run multiple tests on the cleaning portion
print_nums_in_files()
    Create and submit a job to print the number of nodes in each file
__create_slurm_job(file_name, job_name="neo4j"):
    Creates a job with the given characteristics
__create_parallel_slurm_job(file_name, job_name="neo4j, array_size=1):
    Creates a parallel job with the given characteristics
__execute_slurm_job(self, file_name, dependency=None):
    Submits a given job to the cluster
</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8ef5c40a61a26d191645b7cff05b85a8" name="a8ef5c40a61a26d191645b7cff05b85a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ef5c40a61a26d191645b7cff05b85a8">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SlurmJob.SlurmJob.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>account</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>python_env_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_nodes</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cores_per_node</em> = <code>4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mem_per_core</em> = <code>'7G'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>job_duration</em> = <code>'3:00:00'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Constructs attributes for a SlurmJob object

Parameters
----------
account: str
    Account of the pace user
python_env_location: str
    Location of python virtual environment
    If following the docs on submitting a pace job, the location will be:
    /storage/coda1/p-pace-user/0/&lt;USERNAME&gt;/test_installs/neo4j_venv/bin/activate
num_nodes: str, optional
    Number of nodes to use for job
    Default value: 1
cores_per_node: str, optional
    Number of cores per node to use for job
    Default value: 4
mem_per_core: str, optional
    Memory to use per core
    Default value: 7G
job_duration: str, optional
    Time allotted for job
    In format HH:MM:SS
    Default value: 3:00:00
</pre> 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a71b9493100437f493880cc1bcb58ef21" name="a71b9493100437f493880cc1bcb58ef21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71b9493100437f493880cc1bcb58ef21">&#9670;&#160;</a></span>download_files()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SlurmJob.SlurmJob.download_files </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create and submit a job to download all files
Creates an sbatch file to submit: download_files.sbatch
Uses Download.py

Requirements
------------
None

Parameters
----------
None

Returns
-------
None
</pre> 
</div>
</div>
<a id="aa524009a04b18abab5a08ec31cfea1c2" name="aa524009a04b18abab5a08ec31cfea1c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa524009a04b18abab5a08ec31cfea1c2">&#9670;&#160;</a></span>print_nums_in_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SlurmJob.SlurmJob.print_nums_in_file </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create and submit a job to print the number of nodes in each file
Creates the following sbatch files:
counting.sbatch
Uses the following methods:
File.check_num_in_json()
Check output files for results

Requirements
------------
openalex_author_dump_edit.json
openalex_work_dump_edit.json
openalex_collab_dump_edit.json
openalex_institution_dump_edit.json

Parameters
----------
None

Returns
-------
None
</pre> 
</div>
</div>
<a id="a72c79e9e1d0012673919404156da4aae" name="a72c79e9e1d0012673919404156da4aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72c79e9e1d0012673919404156da4aae">&#9670;&#160;</a></span>remove_duplicates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SlurmJob.SlurmJob.remove_duplicates </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create and submit a job to remove all duplicates from the downloaded files
Creates an sbatch file to submit: clean_data.sbatch
Uses the following methods:
Author.remove_duplicate_authors_and_collabs()
Institution.remove_duplicate_institutions()
Work.remove_duplicate_works()

Requirements
------------
openalex_author_dump.json
openalex_work_dump.json
openalex_collab_dump.json
openalex_institution_dump.json

Parameters
----------
None

Returns
-------
None
</pre> 
</div>
</div>
<a id="a666c12fe8852581bd591c04338e585cb" name="a666c12fe8852581bd591c04338e585cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a666c12fe8852581bd591c04338e585cb">&#9670;&#160;</a></span>run_tests_on_cleaning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SlurmJob.SlurmJob.run_tests_on_cleaning </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create and submit a job to run multiple tests on the cleaning portion
Creates the following sbatch files:
cleaning_tests.sbatch
Uses the following methods:
File.check_for_duplicates()
File.compare_to_edit
Author.test_no_duplicates_in_author_and_collab
Author.check_no_lost_collabs
Check output files for results

Requirements
------------
openalex_author_dump.json
openalex_work_dump.json
openalex_collab_dump.json
openalex_institution_dump.json
openalex_author_dump_edit.json
openalex_work_dump_edit.json
openalex_collab_dump_edit.json
openalex_institution_dump_edit.json

Parameters
----------
None

Returns
-------
None
</pre> 
</div>
</div>
<a id="a5890dae9e209eb8029e089c16a171ab8" name="a5890dae9e209eb8029e089c16a171ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5890dae9e209eb8029e089c16a171ab8">&#9670;&#160;</a></span>upload_to_neo4j()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SlurmJob.SlurmJob.upload_to_neo4j </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>database</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create and submit a job to upload all nodes to Neo4j
Creates the following sbatch files:
upload_inst.sbatch
upload_collabs.sbatch
upload_authors.sbatch
upload_works.sbatch
upload_authored.sbatch
Uses the following methods:
Institution.upload_institutions()
Author.upload_collabs_parallel()
Author.upload_current_gt_authors()
Work.upload_works_parallel()
Work.create_authored_relationship()
Uses job dependencies to ensure the jobs run in that order

Requirements
------------
openalex_author_dump_edit.json
openalex_work_dump_edit.json
openalex_collab_dump_edit.json
openalex_institution_dump_edit.json

Parameters
----------
url: str
    URL of the database to connect and upload the nodes to
username: str
    Username of Neo4j user
password: str
    Password of Neo4j user
database: str
    Specific database to upload to

Returns
-------
None
</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>SlurmJob.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
